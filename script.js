// script.js
document.addEventListener('DOMContentLoaded', function() {
    // Initialize AOS
    AOS.init({
        duration: 1000,
        easing: 'ease-in-out',
        once: true
    });

    // Handle splash screen
    handleSplashScreen();

    // Initialize navigation
    initializeNavigation();

    // Initialize modal functionality
    initializeModals();

    // Initialize chat functionality
    initializeChat();

    // Initialize form handling
    initializeFormHandling();
});

// Splash Screen Handler
function handleSplashScreen() {
    setTimeout(() => {
        document.getElementById('splash-screen').style.display = 'none';
        document.getElementById('main-website').style.opacity = '1';
    }, 3000);
}

// Navigation
function initializeNavigation() {
    // Smooth scrolling for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Navbar scroll effect
    window.addEventListener('scroll', function() {
        const navbar = document.querySelector('.navbar');
        if (window.scrollY > 100) {
            navbar.style.background = 'rgba(26, 26, 46, 0.98)';
            navbar.style.backdropFilter = 'blur(20px)';
        } else {
            navbar.style.background = 'rgba(26, 26, 46, 0.95)';
            navbar.style.backdropFilter = 'blur(15px)';
        }
    });
}

// Scroll to Section Function
function scrollToSection(sectionId) {
    const element = document.getElementById(sectionId);
    if (element) {
        element.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
    }
}

// Buy Modal
function showBuyModal() {
    const modal = new bootstrap.Modal(document.getElementById('buyModal'));
    modal.show();
}

// Quantity Controls
function changeQuantity(change) {
    const quantityInput = document.getElementById('quantity');
    let currentValue = parseInt(quantityInput.value);
    let newValue = currentValue + change;

    if (newValue >= 1 && newValue <= 10) {
        quantityInput.value = newValue;
        updateOrderTotal();
    }
}

function updateOrderTotal() {
    const quantity = parseInt(document.getElementById('quantity').value);
    const pricePerUnit = 399;
    const subtotal = quantity * pricePerUnit;

    document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
    document.getElementById('totalAmount').textContent = `$${subtotal.toFixed(2)}`;
}

// Modal Initialization
function initializeModals() {
    // Initialize quantity on modal show
    document.getElementById('buyModal').addEventListener('shown.bs.modal', function() {
        updateOrderTotal();
    });
}

// Chat Functionality
function initializeChat() {
    const chatMessages = document.getElementById('chatMessages');

    // Auto-scroll chat to bottom
    function scrollChatToBottom() {
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Add message to chat
    window.addMessage = function(message, isUser = false) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;

        const avatarClass = isUser ? 'fas fa-user' : 'fas fa-robot';
        const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

        messageDiv.innerHTML = `
            <div class="message-avatar">
                <i class="${avatarClass}"></i>
            </div>
            <div class="message-content">
                <p>${message}</p>
                <span class="message-time">${time}</span>
            </div>
        `;

        chatMessages.appendChild(messageDiv);
        scrollChatToBottom();

        // Add typing animation for bot responses
        if (!isUser) {
            messageDiv.style.opacity = '0';
            messageDiv.style.transform = 'translateY(20px)';
            setTimeout(() => {
                messageDiv.style.transition = 'all 0.3s ease';
                messageDiv.style.opacity = '1';
                messageDiv.style.transform = 'translateY(0)';
            }, 100);
        }
    };
}

// Send Message Function
function sendMessage() {
    const messageInput = document.getElementById('messageInput');
    const message = messageInput.value.trim();

    if (message) {
        // Add user message
        addMessage(message, true);
        messageInput.value = '';

        // Simulate bot response
        setTimeout(() => {
            const botResponse = getBotResponse(message);
            addMessage(botResponse);
        }, 1000);
    }
}

// Handle Enter key in chat
function handleKeyPress(event) {
    if (event.key === 'Enter') {
        sendMessage();
    }
}

// Quick Questions
function sendQuickQuestion(type) {
    const questions = {
        recipes: "Can you show me some recipe ideas for the ChefMaster Pro?",
        features: "What are the main features of the ChefMaster Pro?",
        support: "I need technical support with my cooking machine.",
        warranty: "What warranty coverage do I get with my purchase?"
    };

    const question = questions[type];
    if (question) {
        addMessage(question, true);

        setTimeout(() => {
            const response = getQuickResponse(type);
            addMessage(response);
        }, 1000);
    }
}

// Bot Response Logic
function changeLanguage() {
    const select = document.getElementById('languageSelect');
    const selectedLang = select.value;

    // Indian language greetings
    const greetings = {
        en: "Hello! How can I help you with ChefMaster Pro today? ЁЯШК",
        hi: "рдирдорд╕реНрддреЗ! рдЖрдЬ рдореИрдВ ChefMaster Pro рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЖрдкрдХреА рдХреИрд╕реЗ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реВрдБ? ЁЯШК",
        ta: "ро╡рогроХрпНроХроорпН! ChefMaster Pro рокро▒рпНро▒ро┐ роЗройрпНро▒рпБ роиро╛ройрпН роЙроЩрпНроХро│рпБроХрпНроХрпБ роОрокрпНрокроЯро┐ роЙродро╡ роорпБроЯро┐ропрпБроорпН? ЁЯШК",
        te: "р░ир░ор░╕р▒Нр░Хр░╛р░░р░В! ChefMaster Pro р░Чр▒Бр░░р░┐р░Вр░Ър░┐ р░Ир░░р▒Лр░Ьр▒Б р░ир▒Зр░ир▒Б р░ор▒Ар░Хр▒Б р░Ор░▓р░╛ р░╕р░╣р░╛р░пр░В р░Ър▒Зр░пр░Чр░▓р░ир▒Б? ЁЯШК",
        bn: "ржиржорж╕рзНржХрж╛рж░! ChefMaster Pro рж╕ржорзНржкрж░рзНржХрзЗ ржЖржЬ ржЖржорж┐ ржЖржкржирж╛ржХрзЗ ржХрзАржнрж╛ржмрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рждрзЗ ржкрж╛рж░рж┐? ЁЯШК",
        mr: "рдирдорд╕реНрдХрд╛рд░! ChefMaster Pro рдмрджреНрджрд▓ рдЖрдЬ рдореА рддреБрдордЪреА рдХрд╢реА рдорджрдд рдХрд░реВ рд╢рдХрддреЛ? ЁЯШК",
        gu: "ркиркорк╕рлНркдрлЗ! ChefMaster Pro рк╡рк┐рк╢рлЗ ркЖркЬрлЗ рк╣рлБркВ ркдркорк╛рк░рлА ркХрлЗрк╡рлА рк░рлАркдрлЗ ркоркжркж ркХрк░рлА рк╢ркХрлБркВ? ЁЯШК",
        kn: "р▓ир▓ор▓╕р│Нр▓Хр▓╛р▓░! ChefMaster Pro р▓мр▓Чр│Нр▓Чр│Ж р▓Зр▓Вр▓жр│Б р▓ир▓╛р▓ир│Б р▓ир▓┐р▓ор▓Чр│Ж р▓╣р│Зр▓Чр│Ж р▓╕р▓╣р▓╛р▓п р▓ор▓╛р▓бр▓мр▓╣р│Бр▓жр│Б? ЁЯШК",
        ml: "р┤ир┤ор┤╕р╡Нр┤Хр┤╛р┤░р┤В! ChefMaster Pro р┤Хр╡Бр┤▒р┤┐р┤Ър╡Нр┤Ър╡Н р┤Зр┤ир╡Нр┤ир╡Н р┤Юр┤╛р╡╗ р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Ж р┤Ор┤Щр╡Нр┤Щр┤ир╡Ж р┤╕р┤╣р┤╛р┤пр┤┐р┤Хр╡Нр┤Хр┤╛р┤В? ЁЯШК",
        pa: "ри╕рид ри╕рйНри░рйА риЕриХри╛ри▓! ChefMaster Pro римри╛ри░рйЗ риЕрй▒риЬ риорйИриВ ридрйБри╣ри╛рибрйА риХри┐ри╡рйЗриВ риорижриж риХри░ ри╕риХрижри╛ ри╣ри╛риВ? ЁЯШК"
    };

    setTimeout(() => {
        addMessage(greetings[selectedLang] || greetings.en);
    }, 500);
}

// Enhanced Bot Responses for Indian Context
function getBotResponse(message) {
    const lowerMessage = message.toLowerCase();
    const currentLang = document.getElementById('languageSelect').value;

    // Basic responses in multiple Indian languages
    const responses = {
        en: {
            recipes: "ЁЯН│ ChefMaster Pro comes with 50+ recipes including Indian favorites like Butter Chicken, Biryani, Dal, and Sambar. What type of cuisine would you like to try?",
            price: "ЁЯТ░ ChefMaster Pro is available for тВ╣32,999 (originally тВ╣49,999) - that's 33% off! Free delivery across India. Would you like to place an order?",
            features: "тЬи ChefMaster Pro features AI cooking, 50+ Indian recipes, app control, auto-stirring, and energy efficiency. Perfect for Indian kitchens!",
            shipping: "ЁЯЪЪ We offer FREE delivery across India! Orders reach metro cities in 2-3 days, other cities in 4-7 days.",
            warranty: "ЁЯЫбя╕П 2-year warranty with free service at your doorstep. 30-day money-back guarantee. Call our India support: 1800-CHEF-PRO"
        },
        hi: {
            recipes: "ЁЯН│ ChefMaster Pro рдореЗрдВ 50+ рд╡реНрдпрдВрдЬрди рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдмрдЯрд░ рдЪрд┐рдХрди, рдмрд┐рд░рдпрд╛рдиреА, рджрд╛рд▓, рдФрд░ рд╕рд╛рдВрднрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЖрдк рдХреМрди рд╕рд╛ рд╡реНрдпрдВрдЬрди рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ?",
            price: "ЁЯТ░ ChefMaster Pro тВ╣32,999 рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИ (рдореВрд▓ рдХреАрдордд тВ╣49,999) - 33% рдХреА рдЫреВрдЯ! рдкреВрд░реЗ рднрд╛рд░рдд рдореЗрдВ рдореБрдлреНрдд рдбрд┐рд▓реАрд╡рд░реАред",
            features: "тЬи ChefMaster Pro рдореЗрдВ AI рдХреБрдХрд┐рдВрдЧ, 50+ рднрд╛рд░рддреАрдп рд╡реНрдпрдВрдЬрди, рдРрдк рдХрдВрдЯреНрд░реЛрд▓ рдФрд░ рдСрдЯреЛ-рд╕реНрдЯрд┐рд░рд┐рдВрдЧ рд╣реИред рднрд╛рд░рддреАрдп рд░рд╕реЛрдИ рдХреЗ рд▓рд┐рдП рдмрд┐рд▓реНрдХреБрд▓ рд╕рд╣реА!",
            shipping: "ЁЯЪЪ рдкреВрд░реЗ рднрд╛рд░рдд рдореЗрдВ рдореБрдлреНрдд рдбрд┐рд▓реАрд╡рд░реА! рдореЗрдЯреНрд░реЛ рд╢рд╣рд░реЛрдВ рдореЗрдВ 2-3 рджрд┐рди, рдЕрдиреНрдп рд╢рд╣рд░реЛрдВ рдореЗрдВ 4-7 рджрд┐рди рдореЗрдВ рдбрд┐рд▓реАрд╡рд░реАред",
            warranty: "ЁЯЫбя╕П рдШрд░ рдкрд░ рдореБрдлреНрдд рд╕рд░реНрд╡рд┐рд╕ рдХреЗ рд╕рд╛рде 2 рд╕рд╛рд▓ рдХреА рд╡рд╛рд░рдВрдЯреАред 30 рджрд┐рди рдкреИрд╕реЗ рд╡рд╛рдкрд╕реА рдХреА рдЧрд╛рд░рдВрдЯреАред"
        }
        // Add more languages as needed
    };

    if (lowerMessage.includes('recipe') || lowerMessage.includes('рд╡реНрдпрдВрдЬрди') || lowerMessage.includes('рдЦрд╛рдирд╛')) {
        return responses[currentLang]?.recipes || responses.en.recipes;
    } else if (lowerMessage.includes('price') || lowerMessage.includes('рдХреАрдордд') || lowerMessage.includes('рджрд╛рдо')) {
        return responses[currentLang]?.price || responses.en.price;
    } else if (lowerMessage.includes('features') || lowerMessage.includes('рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ')) {
        return responses[currentLang]?.features || responses.en.features;
    } else if (lowerMessage.includes('shipping') || lowerMessage.includes('рдбрд┐рд▓реАрд╡рд░реА')) {
        return responses[currentLang]?.shipping || responses.en.shipping;
    } else if (lowerMessage.includes('warranty') || lowerMessage.includes('рд╡рд╛рд░рдВрдЯреА')) {
        return responses[currentLang]?.warranty || responses.en.warranty;
    } else {
        return currentLang === 'hi' ?
            "ЁЯШК рдзрдиреНрдпрд╡рд╛рдж! рдореИрдВ ChefMaster Pro рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЖрдкрдХреА рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реВрдБред рд╡реНрдпрдВрдЬрди, рдХреАрдордд, рдпрд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреВрдЫреЗрдВред" :
            "ЁЯШК Thanks for your message! I can help with ChefMaster Pro recipes, pricing, features, or support. What would you like to know?";
    }
}

// Updated Quick Questions for Indian Context
function getQuickResponse(type) {
    const currentLang = document.getElementById('languageSelect').value;

    const responses = {
        en: {
            recipes: "ЁЯН│ <strong>Popular Indian Recipes:</strong><br>тАв Butter Chicken (25 min)<br>тАв Vegetable Biryani (30 min)<br>тАв Dal Tadka (15 min)<br>тАв Chicken Curry (35 min)<br>тАв Sambar (20 min)<br>тАв Rajma (40 min)<br><br>Plus 44 more recipes in the app!",
            features: "тЬи <strong>Perfect for Indian Cooking:</strong><br>тАв AI-Powered Smart Cooking<br>тАв 50+ Indian Recipes<br>тАв Auto-Stirring for Curries<br>тАв Pressure Cooking Mode<br>тАв Rice Cooker Function<br>тАв Energy Efficient<br>тАв Easy Cleanup",
            support: "ЁЯФз <strong>India Support:</strong><br>тАв Hindi & English Support<br>тАв Video Call Assistance<br>тАв Home Service Available<br>тАв Free Installation<br>тАв Toll-Free: 1800-CHEF-PRO<br>тАв WhatsApp: +91-98765-43210",
            warranty: "ЁЯЫбя╕П <strong>India Warranty:</strong><br>тАв 2-Year Full Warranty<br>тАв 30-Day Money Back<br>тАв Home Service in 500+ Cities<br>тАв Free Annual Maintenance<br>тАв Authorized Service Centers<br>тАв Extended Warranty Available"
        },
        hi: {
            recipes: "ЁЯН│ <strong>рд▓реЛрдХрдкреНрд░рд┐рдп рднрд╛рд░рддреАрдп рд╡реНрдпрдВрдЬрди:</strong><br>тАв рдмрдЯрд░ рдЪрд┐рдХрди (25 рдорд┐рдирдЯ)<br>тАв рд╡реЗрдЬ рдмрд┐рд░рдпрд╛рдиреА (30 рдорд┐рдирдЯ)<br>тАв рджрд╛рд▓ рддрдбрд╝рдХрд╛ (15 рдорд┐рдирдЯ)<br>тАв рдЪрд┐рдХрди рдХрд░реА (35 рдорд┐рдирдЯ)<br>тАв рд╕рд╛рдВрднрд░ (20 рдорд┐рдирдЯ)<br>тАв рд░рд╛рдЬрдорд╛ (40 рдорд┐рдирдЯ)<br><br>рдРрдк рдореЗрдВ 44 рдФрд░ рднреА рд╡реНрдпрдВрдЬрди!",
            features: "тЬи <strong>рднрд╛рд░рддреАрдп рдЦрд╛рдирд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд┐рд▓реНрдХреБрд▓ рд╕рд╣реА:</strong><br>тАв AI рд╕реНрдорд╛рд░реНрдЯ рдХреБрдХрд┐рдВрдЧ<br>тАв 50+ рднрд╛рд░рддреАрдп рд╡реНрдпрдВрдЬрди<br>тАв рдХрд░реА рдХреЗ рд▓рд┐рдП рдСрдЯреЛ-рд╕реНрдЯрд┐рд░рд┐рдВрдЧ<br>тАв рдкреНрд░реЗрд╢рд░ рдХреБрдХрд┐рдВрдЧ рдореЛрдб<br>тАв рд░рд╛рдЗрд╕ рдХреБрдХрд░ рдлрдВрдХреНрд╢рди<br>тАв рдКрд░реНрдЬрд╛ рдмрдЪрд╛рдиреЗ рд╡рд╛рд▓рд╛<br>тАв рдЖрд╕рд╛рди рд╕рдлрд╛рдИ",
            support: "ЁЯФз <strong>рднрд╛рд░рдд рд╕рдкреЛрд░реНрдЯ:</strong><br>тАв рд╣рд┐рдВрджреА рдФрд░ рдЕрдВрдЧреНрд░реЗрдЬреА рд╕рдкреЛрд░реНрдЯ<br>тАв рд╡реАрдбрд┐рдпреЛ рдХреЙрд▓ рд╕рд╣рд╛рдпрддрд╛<br>тАв рдШрд░ рдкрд░ рд╕рд░реНрд╡рд┐рд╕ рдЙрдкрд▓рдмреНрдз<br>тАв рдореБрдлреНрдд рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди<br>тАв рдЯреЛрд▓-рдлреНрд░реА: 1800-CHEF-PRO<br>тАв рд╡реНрд╣рд╛рдЯреНрд╕рдПрдк: +91-98765-43210",
            warranty: "ЁЯЫбя╕П <strong>рднрд╛рд░рдд рд╡рд╛рд░рдВрдЯреА:</strong><br>тАв 2 рд╕рд╛рд▓ рдХреА рдкреВрд░реА рд╡рд╛рд░рдВрдЯреА<br>тАв 30 рджрд┐рди рдкреИрд╕реЗ рд╡рд╛рдкрд╕реА<br>тАв 500+ рд╢рд╣рд░реЛрдВ рдореЗрдВ рд╣реЛрдо рд╕рд░реНрд╡рд┐рд╕<br>тАв рдореБрдлреНрдд рд╡рд╛рд░реНрд╖рд┐рдХ рд░рдЦрд░рдЦрд╛рд╡<br>тАв рдЕрдзрд┐рдХреГрдд рд╕рд░реНрд╡рд┐рд╕ рд╕реЗрдВрдЯрд░<br>тАв рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рд╡рд╛рд░рдВрдЯреА рдЙрдкрд▓рдмреНрдз"
        }
    };

    return responses[currentLang]?.[type] || responses.en[type];
}



// Form Handling
function initializeFormHandling() {
    const purchaseForm = document.getElementById('purchaseForm');

    if (purchaseForm) {
        purchaseForm.addEventListener('submit', function(e) {
            e.preventDefault();
            handlePurchaseSubmission();
        });
    }
}

function handlePurchaseSubmission() {
    const submitBtn = document.querySelector('.btn-complete-order');
    const originalText = submitBtn.innerHTML;

    // Show loading state
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing Order...';
    submitBtn.disabled = true;

    // Simulate API call
    setTimeout(() => {
        submitBtn.innerHTML = '<i class="fas fa-check"></i> Order Confirmed!';
        submitBtn.style.background = '#28a745';

        // Show success message
        setTimeout(() => {
            alert('ЁЯОЙ Order confirmed! You will receive a confirmation email shortly. Thank you for choosing ChefMaster Pro!');

            // Reset form
            document.getElementById('purchaseForm').reset();
            updateOrderTotal();
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            submitBtn.style.background = '';

            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('buyModal')).hide();
        }, 2000);
    }, 3000);
}

// Utility Functions
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Performance optimization
document.addEventListener('DOMContentLoaded', function() {
    // Lazy load images
    const images = document.querySelectorAll('img[data-src]');
    const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.src = img.dataset.src;
                img.classList.remove('lazy');
                imageObserver.unobserve(img);
            }
        });
    });

    images.forEach(img => imageObserver.observe(img));

    // Add hover effects
    const buttons = document.querySelectorAll('.btn, .action-btn, .question-btn');
    buttons.forEach(btn => {
        btn.addEventListener('mouseenter', function() {
            this.style.transform = this.style.transform + ' scale(1.02)';
        });

        btn.addEventListener('mouseleave', function() {
            this.style.transform = this.style.transform.replace(' scale(1.02)', '');
        });
    });
});

// Error handling
window.addEventListener('error', function(e) {
    console.error('Error occurred:', e.error);
});

// Analytics tracking (placeholder)
function trackEvent(eventName, properties = {}) {
    console.log('Event tracked:', eventName, properties);
    // Replace with actual analytics code
}

// Track user interactions
document.addEventListener('click', function(e) {
    if (e.target.matches('.action-btn')) {
        trackEvent('Action_Button_Click', { button: e.target.textContent });
    }

    if (e.target.matches('.hotspot')) {
        trackEvent('Hotspot_Interaction', { hotspot: e.target.dataset.hotspot });
    }

    if (e.target.matches('.buy-now-btn')) {
        trackEvent('Buy_Now_Click', { section: 'Product_Explorer' });
    }
});

// Newsletter Subscription Functionality
function subscribeNewsletter() {
    const emailInput = document.getElementById('newsletterEmail');
    const email = emailInput.value.trim();
    const messageDiv = document.getElementById('newsletterMessage');
    const button = document.getElementById('newsletterBtn');

    // Clear previous messages
    messageDiv.className = 'newsletter-message';
    messageDiv.textContent = '';
    emailInput.classList.remove('error', 'success');

    // Validate email
    if (!email) {
        showNewsletterError('Please enter your email address', emailInput, messageDiv);
        return;
    }

    if (!isValidEmail(email)) {
        showNewsletterError('Please enter a valid email address', emailInput, messageDiv);
        return;
    }

    // Show loading state
    const originalIcon = button.innerHTML;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
    button.disabled = true;

    // Simulate API call
    setTimeout(() => {
        // Success state
        emailInput.classList.add('success');
        button.innerHTML = '<i class="fas fa-check"></i>';

        // Show success popup
        showSuccessPopup(email);

        // Clear form after delay
        setTimeout(() => {
            emailInput.value = '';
            emailInput.classList.remove('success');
            button.innerHTML = originalIcon;
            button.disabled = false;
            messageDiv.textContent = '';
        }, 3000);

    }, 1500); // Simulate network delay
}

// Email Validation Function
function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

    // Basic validation checks
    if (!emailRegex.test(email)) return false;
    if (email.length < 5) return false;
    if (email.length > 254) return false;

    // Check for common email providers (optional)
    const domain = email.split('@')[1].toLowerCase();
    const commonDomains = [
        'gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com',
        'rediffmail.com', 'yahoo.in', 'gmail.in', 'live.com',
        'icloud.com', 'protonmail.com', 'yandex.com'
    ];

    // If it's a common domain, it's definitely valid
    if (commonDomains.includes(domain)) return true;

    // For other domains, check if it has proper structure
    return domain.includes('.') && domain.split('.').every(part => part.length > 0);
}

// Show Error Message
function showNewsletterError(message, inputElement, messageElement) {
    inputElement.classList.add('error');
    messageElement.className = 'newsletter-message error';
    messageElement.textContent = message;

    // Shake animation for input
    inputElement.style.animation = 'shake 0.5s ease';
    setTimeout(() => {
        inputElement.style.animation = '';
    }, 500);
}

// Show Success Popup
function showSuccessPopup(email) {
    // Create popup if it doesn't exist
    let popup = document.getElementById('newsletterPopup');
    if (!popup) {
        popup = document.createElement('div');
        popup.id = 'newsletterPopup';
        popup.className = 'newsletter-popup';
        popup.innerHTML = `
            <div class="newsletter-popup-content">
                <div class="newsletter-popup-icon">
                    <i class="fas fa-bell"></i>
                </div>
                <h4>Subscription Confirmed!</h4>
                <p>Thank you for subscribing! You'll receive all the latest updates about ChefMaster Pro, including new recipes, features, and exclusive offers.</p>
                <p><strong>We'll send notifications to:</strong><br><span id="confirmedEmail"></span></p>
                <button class="newsletter-popup-close" onclick="closeNewsletterPopup()">
                    <i class="fas fa-check"></i> Got it!
                </button>
            </div>
        `;
        document.body.appendChild(popup);
    }

    // Update email in popup
    document.getElementById('confirmedEmail').textContent = email;

    // Show popup
    popup.classList.add('show');

    // Auto-close after 5 seconds
    setTimeout(() => {
        closeNewsletterPopup();
    }, 5000);
}

// Close Success Popup
function closeNewsletterPopup() {
    const popup = document.getElementById('newsletterPopup');
    if (popup) {
        popup.classList.remove('show');
    }
}

// Handle Enter key in newsletter input
document.addEventListener('DOMContentLoaded', function() {
    const newsletterInput = document.getElementById('newsletterEmail');
    if (newsletterInput) {
        newsletterInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                subscribeNewsletter();
            }
        });
    }
});

// Add shake animation CSS
const shakeCSS = `
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
}
`;

// Add shake animation to CSS if not already present
if (!document.querySelector('#shakeAnimation')) {
    const style = document.createElement('style');
    style.id = 'shakeAnimation';
    style.textContent = shakeCSS;
    document.head.appendChild(style);
}
